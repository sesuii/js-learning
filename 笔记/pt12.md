<!--
 * @Author: _krill
 * @Date: 2022-08-11 14:55:10
 * @LastEditTime: 2022-08-13 16:01:39
 * @Description: 
-->

# OOP in JavaScript

## æ„é€ å‡½æ•°å’Œ `new`

æ„é€ å‡½æ•°å‘½åæ€»æ˜¯ä»¥å¤§å†™å¼€å¤´ï¼Œå¹¶ä¸”ä¸ºå‡½æ•°å®šä¹‰å’Œå‡½æ•°è¡¨è¾¾å¼å½¢å¼ï¼ŒâŒç®­å¤´å‡½æ•°æ—  `this`ã€‚

**æ­¥éª¤ï¼š**

1. New åˆ›å»ºå¯¹è±¡ {}
2. è°ƒç”¨å‡½æ•°ï¼Œthis = {}
3. å¯¹è±¡ {} é“¾æ¥åˆ°åŸå‹ (åˆ›å»ºå±æ€§ `__proto__` = æ„é€ å‡½æ•°çš„åŸå‹)
4. è¿”å›æ–°å»ºçš„å¯¹è±¡ {} ï¼ˆPerson çš„å®ä¾‹ï¼‰

```js
const Person = function(firstName, birthYear) {
    this.firstName = firstName;
    this.birthYear = birthYear;
    // âŒç³Ÿç³•çš„å®è·µ => å½“åˆ›å»ºå¾ˆå¤šå®ä¾‹æ—¶ï¼Œä¼šåŒæ—¶åˆ›å»ºå¾ˆå¤šä¸ªå‡½æ•°å‰¯æœ¬ï¼Œå½±å“æ€§èƒ½
    this.calcAge = function() {
        return 2037 - this.birthYear;
    };
}
const jonas = new Person('Jonas', 1991);
console.log(jonas instanceof Person)
```

### åŸå‹ç»§æ‰¿ Prototypes / å§”æ‰˜

Js ä¸­æ¯ä¸€ä¸ªå‡½æ•°éƒ½è‡ªåŠ¨æ‹¥æœ‰å±æ€§ `prototype`ï¼Œ**é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºçš„æ¯ä¸€ä¸ªå¯¹è±¡éƒ½èƒ½è®¿é—®æ‰€æœ‰å®šä¹‰åœ¨åŸå‹å±æ€§ä¸Šçš„å±æ€§å’Œæ–¹æ³•**ã€‚

é€šè¿‡ `Person.prototype` åˆ›å»ºçš„æ–¹æ³•ä¸ä¼šè¢«åŒ…å«åœ¨å¯¹è±¡å®ä¾‹ä¸­ï¼Œåªä¼šæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œä½†å› ä¸ºåŸå‹ç»§æ‰¿ï¼Œå¯¹è±¡éƒ½å¯ä»¥è®¿é—®è¯¥æ–¹æ³•ã€‚

```js
Person.prototype.calcAge = function() {
    return 2037 - this.birthYear;
};
console.log(jonas.__proto__);
// Person.prototype æ˜¯å…¨ä½“é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡çš„åŸå‹
console.log(jonas.__proto__ === Person === Person.prototype); // true
console.log(Person.prototype.isPrototypeOf(jonas)); // true
console.log(Person.prototype.isPrototypeOf(Person)); // false
```

åŸå‹ä¹‹ä¸Šåˆ›å»ºå±æ€§ï¼Œä¸æ˜¯é™æ€å±æ€§

```js
Person.prototype.species = 'Home Sapiens';
console.log(jonas.hasOwnProperity('firstName')); // true
console.log(jonas.hasOwnProperity('species')); // false
```

### åŸå‹é“¾

**The Top of prototype chain**: `Object.prototype`

![](../photo/Prototype%20chain.png)

âŒåçš„å®è·µ â€”â€” ä¸ºå†…ç½®å¯¹è±¡æ‰©å±•æ–°çš„æ–¹æ³•

```js
Array.prototype.unique = function() {
    return [...new Set(this)];
};
console.log(arr.unique());
```

## ES6 Classes ã€è¯­æ³•ç³–ã€‘

å®é™…ä¸Šä»ç„¶åº”ç”¨æ„é€ å‡½æ•° & åŸå‹ç»§æ‰¿

```js
// calss expression
const PersonCl = {} 
// class declaration
class PersonCl {
    // new å¯¹è±¡å®ä¾‹æ—¶è‡ªåŠ¨è°ƒç”¨ 
    constructor(firstName, birthYear) {
        this.firstName = firstName;
        this.birthYear = birthYear;
    }
    // å»ºç«‹åœ¨åŸå‹ä¸Š
    calcAge() {
        console.log(2037 - this.birthYear);
    }
};
```
**Hint:**

1. ç±»æ²¡æœ‰è¢«æå‡

2. ç±»ä¹Ÿæ˜¯ä¸€çº§å…¬æ°‘

3. ç±»ä»¥ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œ


## getter and setter

```js
const account = {
    owner: 'Jonas',
    movements: [210, 120, 320, 430, 320],
    get latest() {
        return this.movements.slice(-1).pop();
    },

    set latest(mov) {
        return this.movements.push(mov);
    },
};
```

åœ¨ç±»ä¸­è°ƒç”¨æ„é€ å™¨åˆå§‹åŒ–æˆ–èµ‹å€¼æ—¶ï¼Œç›¸å…³çš„å±æ€§ä¼šè°ƒç”¨è‡ªèº«çš„ `setter` æ–¹æ³•ï¼Œå¯ä»¥è®¾ç½®è§„åˆ™

```js
class PersonCl {
    constructor(fullName, birthYear) {
        this.fullName = fullName;
        this.birthYear = birthYear;
    }
    calcAge() {
        console.log(2037 - this.birthYear);
    }
    // å½“æˆ‘ä»¬å°è¯•è®¾ç½®ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å±æ€§
    set fullName(name) {
        if(name.includes(' ')) this._fullName = name;
        else alert(`${name} is not a full name!`);
    }
    get fullName() {
        return this._fullName;
    }
};
```

## é™æ€æ–¹æ³•

é™æ€æ–¹æ³•ä¸ä¼šå­˜åœ¨äºåŸå‹ä¸­ï¼Œè€Œæ˜¯é™„åŠ åœ¨æ„é€ å‡½æ•°ä¸Šï¼Œå¦‚ `Array.from()`

```js
class Person {
    ...
    static hey = function() {
        ...
    };
};

Person.hey = function() {
    console.log(`Hey, come onğŸ¤`);
}
```

## Object.create()

`Object.create()` æœ¬è´¨ä¸Šæ˜¯**æ‰‹åŠ¨**è®¾ç½®å¯¹è±¡çš„åŸå‹ã€‚ä¸éœ€è¦æ„é€ å‡½æ•°

```js
const PersonProto = {
    calcAge() {
        console.log(2037 - this.birthYear);
    },
    init(firstName, birthYear) {
        this.firstName = firstName;
        this.birthYear = birthYear;
    },
};

const steven = Object.create(PersonProto);
steven.name = 'Steven';
steven.birthYear = 2002;

console.log(steven.__proto__ === PersonProto); // true
```